/*!
 * hash-wasm (https://www.npmjs.com/package/hash-wasm)
 * (c) Dani Biro
 * @license MIT
 */

!function(A,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((A="undefined"!=typeof globalThis?globalThis:A||self).hashwasm=A.hashwasm||{})}(this,(function(A){"use strict";function e(A,e,Q,t){return new(Q||(Q=Promise))((function(I,g){function B(A){try{n(t.next(A))}catch(A){g(A)}}function i(A){try{n(t.throw(A))}catch(A){g(A)}}function n(A){var e;A.done?I(A.value):(e=A.value,e instanceof Q?e:new Q((function(A){A(e)}))).then(B,i)}n((t=t.apply(A,e||[])).next())}))}class Q{constructor(){this.mutex=Promise.resolve()}lock(){let A=()=>{};return this.mutex=this.mutex.then((()=>new Promise(A))),new Promise((e=>{A=e}))}dispatch(A){return e(this,void 0,void 0,(function*(){const e=yield this.lock();try{return yield Promise.resolve(A())}finally{e()}}))}}var t;const I="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,g=null!==(t=I.Buffer)&&void 0!==t?t:null,B=I.TextEncoder?new I.TextEncoder:null;function i(A,e){return(15&A)+(A>>6|A>>3&8)<<4|(15&e)+(e>>6|e>>3&8)}const n="a".charCodeAt(0)-10,C="0".charCodeAt(0);function o(A,e,Q){let t=0;for(let I=0;I<Q;I++){let Q=e[I]>>>4;A[t++]=Q>9?Q+n:Q+C,Q=15&e[I],A[t++]=Q>9?Q+n:Q+C}return String.fromCharCode.apply(null,A)}const r=null!==g?A=>{if("string"==typeof A){const e=g.from(A,"utf8");return new Uint8Array(e.buffer,e.byteOffset,e.length)}if(g.isBuffer(A))return new Uint8Array(A.buffer,A.byteOffset,A.length);if(ArrayBuffer.isView(A))return new Uint8Array(A.buffer,A.byteOffset,A.byteLength);throw new Error("Invalid data type!")}:A=>{if("string"==typeof A)return B.encode(A);if(ArrayBuffer.isView(A))return new Uint8Array(A.buffer,A.byteOffset,A.byteLength);throw new Error("Invalid data type!")},E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=new Uint8Array(256);for(let A=0;A<E.length;A++)c[E.charCodeAt(A)]=A;function a(A){const e=function(A){let e=Math.floor(.75*A.length);const Q=A.length;return"="===A[Q-1]&&(e-=1,"="===A[Q-2]&&(e-=1)),e}(A),Q=A.length,t=new Uint8Array(e);let I=0;for(let e=0;e<Q;e+=4){const Q=c[A.charCodeAt(e)],g=c[A.charCodeAt(e+1)],B=c[A.charCodeAt(e+2)],i=c[A.charCodeAt(e+3)];t[I]=Q<<2|g>>4,I+=1,t[I]=(15&g)<<4|B>>2,I+=1,t[I]=(3&B)<<6|63&i,I+=1}return t}const h=16384,s=new Q,d=new Map;function l(A,Q){return e(this,void 0,void 0,(function*(){let t=null,I=null,g=!1;if("undefined"==typeof WebAssembly)throw new Error("WebAssembly is not supported in this environment!");const B=()=>new DataView(t.exports.memory.buffer).getUint32(t.exports.STATE_SIZE,!0),n=s.dispatch((()=>e(this,void 0,void 0,(function*(){if(!d.has(A.name)){const e=a(A.data),Q=WebAssembly.compile(e);d.set(A.name,Q)}const e=yield d.get(A.name);t=yield WebAssembly.instantiate(e,{})})))),C=(A=null)=>{g=!0,t.exports.Hash_Init(A)},E=A=>{if(!g)throw new Error("update() called before init()");(A=>{let e=0;for(;e<A.length;){const Q=A.subarray(e,e+h);e+=Q.length,I.set(Q),t.exports.Hash_Update(Q.length)}})(r(A))},c=new Uint8Array(2*Q),l=(A,e=null)=>{if(!g)throw new Error("digest() called before init()");return g=!1,t.exports.Hash_Final(e),"binary"===A?I.slice(0,Q):o(c,I,Q)},y=A=>"string"==typeof A?A.length<4096:A.byteLength<h;let f=y;switch(A.name){case"argon2":case"scrypt":f=()=>!0;break;case"blake2b":case"blake2s":f=(A,e)=>e<=512&&y(A);break;case"blake3":f=(A,e)=>0===e&&y(A);break;case"xxhash64":case"xxhash3":case"xxhash128":f=()=>!1}return yield(()=>e(this,void 0,void 0,(function*(){t||(yield n);const A=t.exports.Hash_GetBuffer(),e=t.exports.memory.buffer;I=new Uint8Array(e,A,h)})))(),{getMemory:()=>I,writeMemory:(A,e=0)=>{I.set(A,e)},getExports:()=>t.exports,setMemorySize:A=>{t.exports.Hash_SetMemorySize(A);const e=t.exports.Hash_GetBuffer(),Q=t.exports.memory.buffer;I=new Uint8Array(Q,e,A)},init:C,update:E,digest:l,save:()=>{if(!g)throw new Error("save() can only be called after init() and before digest()");const e=t.exports.Hash_GetState(),Q=B(),I=t.exports.memory.buffer,n=new Uint8Array(I,e,Q),C=new Uint8Array(4+Q);return function(A,e){const Q=e.length>>1;for(let t=0;t<Q;t++){const Q=t<<1;A[t]=i(e.charCodeAt(Q),e.charCodeAt(Q+1))}}(C,A.hash),C.set(n,4),C},load:e=>{if(!(e instanceof Uint8Array))throw new Error("load() expects an Uint8Array generated by save()");const Q=t.exports.Hash_GetState(),I=B(),n=4+I,C=t.exports.memory.buffer;if(e.length!==n)throw new Error(`Bad state length (expected ${n} bytes, got ${e.length})`);if(!function(A,e){if(A.length!==2*e.length)return!1;for(let Q=0;Q<e.length;Q++){const t=Q<<1;if(e[Q]!==i(A.charCodeAt(t),A.charCodeAt(t+1)))return!1}return!0}(A.hash,e.subarray(0,4)))throw new Error("This state was written by an incompatible hash implementation");const o=e.subarray(4);new Uint8Array(C,Q,I).set(o),g=!0},calculate:(A,e=null,g=null)=>{if(!f(A,e))return C(e),E(A),l("hex",g);const B=r(A);return I.set(B),t.exports.Hash_Calculate(B.length,e,g),o(c,I,Q)},hashLength:Q}}))}var y={name:"sm3",data:"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",hash:"d56c306e"};const f=new Q;let u=null;A.createSM3=function(){return l(y,32).then((A=>{A.init();const e={init:()=>(A.init(),e),update:Q=>(A.update(Q),e),digest:e=>A.digest(e),save:()=>A.save(),load:Q=>(A.load(Q),e),blockSize:64,digestSize:32};return e}))},A.sm3=function(A){if(null===u)return function(A,Q,t){return e(this,void 0,void 0,(function*(){const e=yield A.lock(),I=yield l(Q,t);return e(),I}))}(f,y,32).then((e=>(u=e,u.calculate(A))));try{const e=u.calculate(A);return Promise.resolve(e)}catch(A){return Promise.reject(A)}},Object.defineProperty(A,"__esModule",{value:!0})}));
