{"version":3,"file":"asn1-validator.js","sources":["../../../../node_modules/node-forge/lib/asn1-validator.js"],"sourcesContent":["/**\n * Copyright (c) 2019 Digital Bazaar, Inc.\n */\n\nvar forge = require('./forge');\nrequire('./asn1');\nvar asn1 = forge.asn1;\n\nexports.privateKeyValidator = {\n  // PrivateKeyInfo\n  name: 'PrivateKeyInfo',\n  tagClass: asn1.Class.UNIVERSAL,\n  type: asn1.Type.SEQUENCE,\n  constructed: true,\n  value: [{\n    // Version (INTEGER)\n    name: 'PrivateKeyInfo.version',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.INTEGER,\n    constructed: false,\n    capture: 'privateKeyVersion'\n  }, {\n    // privateKeyAlgorithm\n    name: 'PrivateKeyInfo.privateKeyAlgorithm',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.SEQUENCE,\n    constructed: true,\n    value: [{\n      name: 'AlgorithmIdentifier.algorithm',\n      tagClass: asn1.Class.UNIVERSAL,\n      type: asn1.Type.OID,\n      constructed: false,\n      capture: 'privateKeyOid'\n    }]\n  }, {\n    // PrivateKey\n    name: 'PrivateKeyInfo',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.OCTETSTRING,\n    constructed: false,\n    capture: 'privateKey'\n  }]\n};\n\nexports.publicKeyValidator = {\n  name: 'SubjectPublicKeyInfo',\n  tagClass: asn1.Class.UNIVERSAL,\n  type: asn1.Type.SEQUENCE,\n  constructed: true,\n  captureAsn1: 'subjectPublicKeyInfo',\n  value: [{\n    name: 'SubjectPublicKeyInfo.AlgorithmIdentifier',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.SEQUENCE,\n    constructed: true,\n    value: [{\n      name: 'AlgorithmIdentifier.algorithm',\n      tagClass: asn1.Class.UNIVERSAL,\n      type: asn1.Type.OID,\n      constructed: false,\n      capture: 'publicKeyOid'\n    }]\n  },\n  // capture group for ed25519PublicKey\n  {\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.BITSTRING,\n    constructed: false,\n    composed: true,\n    captureBitStringValue: 'ed25519PublicKey'\n  }\n  // FIXME: this is capture group for rsaPublicKey, use it in this API or\n  // discard?\n  /* {\n    // subjectPublicKey\n    name: 'SubjectPublicKeyInfo.subjectPublicKey',\n    tagClass: asn1.Class.UNIVERSAL,\n    type: asn1.Type.BITSTRING,\n    constructed: false,\n    value: [{\n      // RSAPublicKey\n      name: 'SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey',\n      tagClass: asn1.Class.UNIVERSAL,\n      type: asn1.Type.SEQUENCE,\n      constructed: true,\n      optional: true,\n      captureAsn1: 'rsaPublicKey'\n    }]\n  } */\n  ]\n};\n"],"names":["require$$0"],"mappings":";;;;;;;;;AAIA,IAAI,KAAK,GAAGA,OAAkB,CAAC;AACb;AAClB,IAAI,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;AACtB;iCAC2B,GAAG;AAC9B;AACA,EAAE,IAAI,EAAE,gBAAgB;AACxB,EAAE,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;AAChC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ;AAC1B,EAAE,WAAW,EAAE,IAAI;AACnB,EAAE,KAAK,EAAE,CAAC;AACV;AACA,IAAI,IAAI,EAAE,wBAAwB;AAClC,IAAI,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;AAClC,IAAI,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO;AAC3B,IAAI,WAAW,EAAE,KAAK;AACtB,IAAI,OAAO,EAAE,mBAAmB;AAChC,GAAG,EAAE;AACL;AACA,IAAI,IAAI,EAAE,oCAAoC;AAC9C,IAAI,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;AAClC,IAAI,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ;AAC5B,IAAI,WAAW,EAAE,IAAI;AACrB,IAAI,KAAK,EAAE,CAAC;AACZ,MAAM,IAAI,EAAE,+BAA+B;AAC3C,MAAM,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;AACpC,MAAM,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG;AACzB,MAAM,WAAW,EAAE,KAAK;AACxB,MAAM,OAAO,EAAE,eAAe;AAC9B,KAAK,CAAC;AACN,GAAG,EAAE;AACL;AACA,IAAI,IAAI,EAAE,gBAAgB;AAC1B,IAAI,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;AAClC,IAAI,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW;AAC/B,IAAI,WAAW,EAAE,KAAK;AACtB,IAAI,OAAO,EAAE,YAAY;AACzB,GAAG,CAAC;AACJ,EAAE;AACF;gCAC0B,GAAG;AAC7B,EAAE,IAAI,EAAE,sBAAsB;AAC9B,EAAE,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;AAChC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ;AAC1B,EAAE,WAAW,EAAE,IAAI;AACnB,EAAE,WAAW,EAAE,sBAAsB;AACrC,EAAE,KAAK,EAAE,CAAC;AACV,IAAI,IAAI,EAAE,0CAA0C;AACpD,IAAI,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;AAClC,IAAI,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ;AAC5B,IAAI,WAAW,EAAE,IAAI;AACrB,IAAI,KAAK,EAAE,CAAC;AACZ,MAAM,IAAI,EAAE,+BAA+B;AAC3C,MAAM,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;AACpC,MAAM,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG;AACzB,MAAM,WAAW,EAAE,KAAK;AACxB,MAAM,OAAO,EAAE,cAAc;AAC7B,KAAK,CAAC;AACN,GAAG;AACH;AACA,EAAE;AACF,IAAI,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;AAClC,IAAI,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS;AAC7B,IAAI,WAAW,EAAE,KAAK;AACtB,IAAI,QAAQ,EAAE,IAAI;AAClB,IAAI,qBAAqB,EAAE,kBAAkB;AAC7C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH"}